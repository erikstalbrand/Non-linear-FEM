function [D] = dMaterAxi2(flag, mpara, defgrad)

F = [defgrad(1) defgrad(2) 0;
     defgrad(3) defgrad(4) 0;
        0          0       defgrad(5)];                              % 1 is (1,1), 4 is (2,2), 2 is (1,2), 3 is (2,1)

C = F'*F;
mu = mpara(1)/(2*(1+mpara(2)));
% I_1C = C(1, 1) + C(2, 2) + C(3, 3);

k = mpara(1)/(3*(1-2*mpara(2)));
J = det(F);

%S = k/2*(J^2-1)*inv(C)+mu*J^(-2/3)*(I-I_1C/3*inv(C));

c = inv(C);

a1 = k*J^2+2*mu/9*J^(-2/3)*(C(1, 1) + C(2, 2) + C(3, 3));
a2 = 2*mu/3*J^(-2/3);
a3 = mu/3*J^(-2/3)*(C(1, 1) + C(2, 2) + C(3, 3)) - k/2*(J^2-1);

D_1111 = a1*(c(1, 1)*c(1, 1)) - a2*(c(1, 1)+c(1, 1)) + a3*((c(1, 1)*c(1, 1)) + (c(1, 1)*c(1, 1)));
D_1122 = a1*(c(1, 1)*c(2, 2)) - a2*(c(2, 2)+c(1, 1)) + a3*((c(1, 2)*c(1, 2)) + (c(1, 2)*c(1, 2)));
D_1112 = a1*(c(1, 1)*c(1, 2)) - a2*(c(1, 2)+ 0)      + a3*(c(1, 1)*c(1, 2) + (c(1, 2)*c(1, 1)));
D_2211 = a1*(c(2, 2)*c(1, 1)) - a2*(c(1, 1)+c(2, 2)) + a3*((c(2, 1)*c(2, 1)) + (c(2, 1)*c(2, 1)));
D_2222 = a1*(c(2, 2)*c(2, 2)) - a2*(c(2, 2)+c(2, 2)) + a3*((c(2, 2)*c(2, 2)) + (c(2, 2)*c(2, 2)));
D_2212 = a1*(c(2, 2)*c(1, 2)) - a2*(c(1, 2)+ 0)      + a3*((c(2, 1)*c(2, 2)) + (c(2, 2)*c(2, 1)));
D_1211 = a1*(c(1, 2)*c(1, 1)) - a2*(0 + c(1, 2))     + a3*((c(1, 1)*c(2, 1)) + (c(1, 1)*c(2, 1)));
D_1222 = a1*(c(1, 2)*c(2, 2)) - a2*(0 + c(1, 2))     + a3*((c(1, 2)*c(2, 2)) + (c(1, 2)*c(2, 2)));
D_1212 = a1*(c(1, 2)*c(1, 2)) - a2*(0 + 0)           + a3*(c(1, 1)*c(2, 2) + (c(1, 2)*c(1, 2)));

%---------------------
D_1133 = a1*(c(1, 1)*c(3, 3)) - a2*(c(3, 3)+c(1, 1)) + a3*((c(1, 3)*c(1, 3)) + (c(1, 3)*c(1, 3)));
D_2233 = a1*(c(2, 2)*c(3, 3)) - a2*(c(3, 3)+c(2, 2)) + a3*((c(2, 3)*c(2, 3)) + (c(2, 3)*c(2, 3)));
D_3333 = a1*(c(3, 3)*c(3, 3)) - a2*(c(3, 3)+c(3, 3)) + a3*((c(3, 3)*c(3, 3)) + (c(3, 3)*c(3, 3)));
D_3312 = a1*(c(3, 3)*c(1, 2)) - a2*(c(1, 2) + 0 ) + a3*((c(3, 1)*c(3, 2)) + (c(3, 2)*c(3, 1)));
%----
D_3311 = D_1133;
D_3322 = D_2233;
D_1233 = D_3312;

%---------------------
D = [D_1111 D_1122 D_1133 D_1112;
    D_2211 D_2222 D_2233 D_2212;
    D_3311 D_3322 D_3333 D_3312;
    D_1211 D_1222 D_1233 D_1212];
end

